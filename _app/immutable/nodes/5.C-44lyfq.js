import{f as Z,a as j,c as Xt,t as Yt}from"../chunks/Dl5Yzwme.js";import"../chunks/BhKfAKPo.js";import{o as Zt}from"../chunks/DjN3QPGq.js";import{a2 as te,N as H,aq as St,ar as ee,a4 as ne,g as t,c as k,O as _,s as F,r as v,a5 as ae,a3 as re,u as S,t as yt}from"../chunks/B8hsJoxf.js";import{e as ft,s as xt}from"../chunks/Cj8dfRza.js";import{i as pt}from"../chunks/BL7Ms3Bf.js";import{r as gt,e as kt,i as wt,b as Mt}from"../chunks/CrMFJSnh.js";import{b as oe,d as $t}from"../chunks/fQjJrMy0.js";import{i as ie}from"../chunks/nTidvg6x.js";import{C as se}from"../chunks/xmn1E3Al.js";import{i as Nt,r as le,s as mt,a as ce,b as ue,l as fe}from"../chunks/DlWHExRM.js";class Et extends Map{constructor(l,c=ge){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:c}}),l!=null)for(const[r,i]of l)this.set(r,i)}get(l){return super.get(jt(this,l))}has(l){return super.has(jt(this,l))}set(l,c){return super.set(pe(this,l),c)}delete(l){return super.delete(de(this,l))}}function jt({_intern:e,_key:l},c){const r=l(c);return e.has(r)?e.get(r):c}function pe({_intern:e,_key:l},c){const r=l(c);return e.has(r)?e.get(r):(e.set(r,c),c)}function de({_intern:e,_key:l},c){const r=l(c);return e.has(r)&&(c=e.get(r),e.delete(r)),c}function ge(e){return e!==null&&typeof e=="object"?e.valueOf():e}const Ft=Symbol("implicit");function Tt(){var e=new Et,l=[],c=[],r=Ft;function i(u){let w=e.get(u);if(w===void 0){if(r!==Ft)return r;e.set(u,w=l.push(u)-1)}return c[w%c.length]}return i.domain=function(u){if(!arguments.length)return l.slice();l=[],e=new Et;for(const w of u)e.has(w)||e.set(w,l.push(w)-1);return i},i.range=function(u){return arguments.length?(c=Array.from(u),i):c.slice()},i.unknown=function(u){return arguments.length?(r=u,i):r},i.copy=function(){return Tt(l,c).unknown(r)},Nt.apply(i,arguments),i}function Ot(){var e=Tt().unknown(void 0),l=e.domain,c=e.range,r=0,i=1,u,w,$=!1,M=0,N=0,q=.5;delete e.unknown;function b(){var p=l().length,ot=i<r,T=ot?i:r,C=ot?r:i;u=(C-T)/Math.max(1,p-M+N*2),$&&(u=Math.floor(u)),T+=(C-T-u*(p-M))*q,w=u*(1-M),$&&(T=Math.round(T),w=Math.round(w));var z=le(p).map(function(E){return T+u*E});return c(ot?z.reverse():z)}return e.domain=function(p){return arguments.length?(l(p),b()):l()},e.range=function(p){return arguments.length?([r,i]=p,r=+r,i=+i,b()):[r,i]},e.rangeRound=function(p){return[r,i]=p,r=+r,i=+i,$=!0,b()},e.bandwidth=function(){return w},e.step=function(){return u},e.round=function(p){return arguments.length?($=!!p,b()):$},e.padding=function(p){return arguments.length?(M=Math.min(1,N=+p),b()):M},e.paddingInner=function(p){return arguments.length?(M=Math.min(1,p),b()):M},e.paddingOuter=function(p){return arguments.length?(N=+p,b()):N},e.align=function(p){return arguments.length?(q=Math.max(0,Math.min(1,p)),b()):q},e.copy=function(){return Ot(l(),[r,i]).round($).paddingInner(M).paddingOuter(N).align(q)},Nt.apply(b(),arguments)}var me=Z('<br/> <div class="animate-ping">Loading Account History</div> <br/>',1),he=Z('<li><label class="flex items-center gap-2 text-xs text-ht_hiveblack"><input type="checkbox"/> <span> </span></label></li>'),ve=Z('<ul class="ml-6 list-disc space-y-1"></ul>'),be=Z('<li><label class="flex items-center gap-2 text-xs text-ht_hiveblack"><input type="checkbox"/> <span> </span></label></li>'),_e=Z('<ul class="ml-6 list-disc space-y-1"></ul>'),ye=Z('<li><label class="flex items-center gap-2"><input type="checkbox"/> <span> </span></label> <!> <!></li>'),xe=Z('<div class="mt-6 text-left text-sm"><div class="font-semibold mb-2">Activity breakdown</div> <ul class="space-y-2"></ul></div>'),ke=Z('<main slot="content"><div class="flex flex-col items-center gap-3 w-full"><label class="flex flex-col items-center gap-2 text-sm font-semibold text-gray-600 w-full max-w-[14rem]"><div class="flex w-full items-center gap-2 justify-center"><input type="text" placeholder="Account Name" class="w-full rounded-xl border px-3 py-2 text-base text-ht_hiveblack focus:border-ht_hiveblack focus:outline-none text-center border-gray-300"/> <button class="rounded-full border px-5 py-2 text-sm font-semibold shadow focus:outline-none transition whitespace-nowrap bg-white text-ht_hiveblack border-gray-200" style="box-shadow:0 10px 25px -12px rgba(0,0,0,0.5);">Load</button></div></label></div> <br/> <div class="inline-block text-lg text-ht_hiveblack font-medium title-font mb-2"><br/> <!> <div id="chart"></div> <!></div></main>');function je(e,l){te(l,!1);const c=H();let r="Account activity",i=H(!1),u,w,$,M,N=H(""),q=H(!1),b,p=0,ot=0,T="",C=H(null);const z=[{key:"vote",label:"Votes"},{key:"blog",label:"Blog posts"},{key:"comment",label:"Comments"},{key:"custom",label:"Custom JSON"},{key:"other",label:"Other"}];let E=H(z.reduce((a,o)=>({...a,[o.key]:!0}),{})),At=H(z.map(a=>({key:a.key,label:a.label,count:0}))),K=H([]),I=H({}),Ct={},W=H([]),L=H({}),Dt={},It="",Lt="",Pt="",Gt="";Zt(async function(){ht()});const Jt=a=>{a.code==="Enter"&&ht()};function P(){return Array.from({length:7},()=>Array(24).fill(0))}function Rt(){return{vote:P(),blog:P(),comment:P(),custom:P(),other:P()}}function Ut(a){if(!a||!a.length)return"other";const[o,g]=a;return o==="vote"?"vote":o==="comment"?g!=null&&g.parent_author?"comment":"blog":o==="custom_json"?"custom":"other"}function Vt(){if(!t(C))return P();const a=P(),o=g=>{for(let m=0;m<7;m++)for(let f=0;f<24;f++)a[m][f]+=g[m][f]};for(const{key:g}of z)if(t(E)[g]){if(g==="other"){const m=t(K).length?t(K):[["__all__",0]];for(const[f]of m){if(f!=="__all__"&&!Bt(f))continue;const O=f==="__all__"?t(C).other:Ct[f];O&&o(O)}continue}if(g==="custom"){const m=t(W).length?t(W):[["__all__",0]];for(const[f]of m){if(f!=="__all__"&&!Ht(f))continue;const O=f==="__all__"?t(C).custom:Dt[f];O&&o(O)}continue}o(t(C)[g])}return a}function Bt(a){return!t(K).length||Object.keys(t(I)).length===0?!0:t(I)[a]!==!1}function qt(){if(!t(C))return;const a=Vt();mt("#chart").select("svg").remove();var o={top:30,right:30,bottom:30,left:30},g=750-o.left-o.right,m=450-o.top-o.bottom,f=mt("#chart").append("svg").attr("width",g+o.left+o.right).attr("height",m+o.top+o.bottom).append("g").attr("transform","translate("+o.left+","+o.top+")"),O=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],Q=[0,1,2,3,4,5,6],y=Ot().range([0,g]).domain(O).padding(.01);f.append("g").attr("transform","translate(0,"+m+")").call(ce(y));var G=Ot().range([m,0]).domain(Q).padding(.01);f.append("g").call(ue(G));var J=fe().range(["lightgray","yellow","orange","red"]).domain([1,200,800,4e3]),tt=f.append("defs"),R=tt.append("linearGradient").attr("id","linear-gradient");R.attr("x1","0%").attr("y1","0%").attr("x2","100%").attr("y2","0%"),R.selectAll("stop").data(J.range()).enter().append("stop").attr("offset",function(n,B){return B/(J.range().length-1)}).attr("stop-color",function(n){return n});let X=[];for(var D=0;D<7;D++)for(var d=0;d<24;d++)X.push({hour:d,day:D,value:a[D][d]});f.selectAll().data(X,function(n){return n.hour+":"+n.day}).enter().append("rect").attr("x",function(n){return y(n.hour)}).attr("y",function(n){return G(n.day)}).attr("width",y.bandwidth()).attr("height",G.bandwidth()).style("fill",function(n){return J(n.value)});var s=f.append("g").attr("class","legendWrapper").attr("transform","translate("+(g/2-150)+","+(m+20)+")");s.append("rect").attr("width",300).attr("height",10).style("fill","url(#linear-gradient)")}function zt(a){_(E,{...t(E),[a]:!t(E)[a]})}function Kt(a){const o=t(I)[a]??!0;_(I,{...t(I),[a]:!o})}function Ht(a){return!t(W).length||Object.keys(t(L)).length===0?!0:t(L)[a]!==!1}function Wt(a){const o=t(L)[a]??!0;_(L,{...t(L),[a]:!o})}async function ht(){const a=t(N).trim();if(!a){M="",_(i,!1),$="",mt("#chart").select("svg").remove();return}_(q,!0),$="",M="",_(i,!1),mt("#chart").select("svg").remove();try{const o=new $t.Client(["https://api.hive.blog","https://api.hivekings.com","https://anyx.io","https://api.openhive.network"]),g=new $t.DatabaseAPI(o),m=await o.database.call("lookup_accounts",[a,1]);if(console.log(m),u=await o.database.call("get_accounts",[m]),w=await u[0],console.log(u),console.log(u[0]),a==u[0].name){if(u[0].json_metadata){let s=JSON.parse(u[0].json_metadata);s.profile&&(console.log(s.profile.profile_image),$=s.profile.profile_image)}M=u[0].name}M==""&&(M="!!! Account not found !!!");const f=await o.database.call("get_account_history",["exodegame","-1","10"]);console.log(f),It=Lt=Pt=Gt="M0 0";const O=Rt();let Q=[],y=-1,G=1e3,J=!1;const tt=new Map,R={},X=new Map,D={},d=z.reduce((s,n)=>({...s,[n.key]:0}),{});for(let s=0;s<20;s++)y!=0&&!J&&(y>0&&y<1e3&&(G=y),console.log("start: "+y),b=await g.getAccountHistory(a,y,G),console.log(b),await b.forEach(function(n){var st,dt,lt;p++,ot=n[0],T=n[1].timestamp,Q.push(ot+" "+T+" "+n[1].op[1].id+" "+n[1].op[1].json+`
`),(y==-1||n[0]<y)&&(y=n[0]);var B=new Date(Date.parse(n[1].timestamp+"+00:00")),h=B.getUTCHours(),U=B.getUTCDay(),it=new Date,Y=new Date;if(Y.setDate(it.getDate()-7),B>=Y&&B<=it){const et=Ut(n[1].op);if(O[et][U][h]+=50,d[et]=(d[et]||0)+1,et==="other"){const A=((st=n[1].op)==null?void 0:st[0])||"unknown";tt.set(A,(tt.get(A)||0)+1),R[A]||(R[A]=P()),R[A][U][h]+=50}else if(et==="custom"){const A=((lt=(dt=n[1].op)==null?void 0:dt[1])==null?void 0:lt.id)||"unknown";X.set(A,(X.get(A)||0)+1),D[A]||(D[A]=P()),D[A][U][h]+=50}}B<=Y&&(J=!0)}));_(C,O),_(At,z.map(s=>({key:s.key,label:s.label,count:d[s.key]||0}))),Ct=R,_(K,Array.from(tt.entries()).sort((s,n)=>n[1]-s[1])),_(I,t(K).reduce((s,[n])=>({...s,[n]:t(I)[n]??!0}),{})),Dt=D,_(W,Array.from(X.entries()).sort((s,n)=>n[1]-s[1])),_(L,t(W).reduce((s,[n])=>({...s,[n]:t(L)[n]??!0}),{})),_(i,!0)}finally{_(q,!1)}b.forEach(function(o){p++}),b=await database.getAccountHistory("exodegame",-100,100),b.forEach(function(o){p++})}St(()=>(t(E),t(I),t(L)),()=>{_(c,JSON.stringify({activity:t(E),other:t(I),custom:t(L)}))}),St(()=>(t(C),t(i),t(c)),()=>{t(C)&&t(i)&&(t(c),qt())}),ee(),ie(),se(e,{title:r,$$slots:{content:(a,o)=>{var g=ke(),m=k(g),f=k(m),O=k(f),Q=k(O);gt(Q);var y=F(Q,2);v(O),v(f),v(m);var G=F(m,4),J=F(k(G),2);{var tt=d=>{var s=me();ae(4),j(d,s)},R=d=>{var s=Xt(),n=re(s);{var B=h=>{var U=Yt("activity of the last week");j(h,U)};pt(n,h=>{t(i)&&h(B)},!0)}j(d,s)};pt(J,d=>{t(q)?d(tt):d(R,!1)})}var X=F(J,4);{var D=d=>{var s=xe(),n=F(k(s),2);kt(n,5,()=>t(At),wt,(B,h)=>{var U=ye(),it=k(U),Y=k(it);gt(Y);var st=F(Y,2),dt=k(st);v(st),v(it);var lt=F(it,2);{var et=nt=>{var at=ve();kt(at,5,()=>t(W),wt,(vt,x)=>{var rt=he(),ct=k(rt),V=k(ct);gt(V);var ut=F(V,2),bt=k(ut);v(ut),v(ct),v(rt),yt(_t=>{Mt(V,_t),xt(bt,`${t(x),S(()=>t(x)[0])??""}: ${t(x),S(()=>t(x)[1])??""}`)},[()=>(t(x),S(()=>Ht(t(x)[0])))]),ft("change",V,()=>Wt(t(x)[0])),j(vt,rt)}),v(at),j(nt,at)};pt(lt,nt=>{t(h),t(W),S(()=>t(h).key==="custom"&&t(W).length)&&nt(et)})}var A=F(lt,2);{var Qt=nt=>{var at=_e();kt(at,5,()=>t(K),wt,(vt,x)=>{var rt=be(),ct=k(rt),V=k(ct);gt(V);var ut=F(V,2),bt=k(ut);v(ut),v(ct),v(rt),yt(_t=>{Mt(V,_t),xt(bt,`${t(x),S(()=>t(x)[0])??""}: ${t(x),S(()=>t(x)[1])??""}`)},[()=>(t(x),S(()=>Bt(t(x)[0])))]),ft("change",V,()=>Kt(t(x)[0])),j(vt,rt)}),v(at),j(nt,at)};pt(A,nt=>{t(h),t(K),S(()=>t(h).key==="other"&&t(K).length)&&nt(Qt)})}v(U),yt(()=>{Mt(Y,(t(E),t(h),S(()=>t(E)[t(h).key]))),xt(dt,`${t(h),S(()=>t(h).label)??""}: ${t(h),S(()=>t(h).count)??""}`)}),ft("change",Y,()=>zt(t(h).key)),j(B,U)}),v(n),v(s),j(d,s)};pt(X,d=>{t(i)&&d(D)})}v(G),v(g),ft("keypress",Q,Jt),oe(Q,()=>t(N),d=>_(N,d)),ft("click",y,ht),j(a,g)}}}),ne()}export{je as component};
